# 5장 서버

## 5.1 서버 저장소

### 5.1.1 협업 저장소

### 5.1.2 연속된 작업

### 5.1.3 새 멤버

---

## 5.2 깃허브 서버 준비

### 5.2.1 깃허브

### 5.2.2 저장소 생성

---

## 5.3 깃허브 연동 및 원격 등록

### 5.3.1 로컬 저장소

```
$ mkdir gitstudy05
$ cd gitstudy05
$ git init

$ echo "# gitstudy05" >> README.md

$ git add README.md
$ git commit -m "first commit"
```

### 5.3.2 프로토콜

깃은 서버와 통신할 수 있는 다양한 프로토콜을 지원한다.

> Local

    -   로컬 컴퓨터에서 원격 저장소를 생성하는 것을 의미
    -   자신의 컴퓨터를 NFS(Network File System) 등 서버로 이용할 때 편리하다.
    -   로컬 저장소를 서버로 이용할 때는 폴더 경로만 입력하면 된다.
        -   $ git remote add 원격저장소별칭 폴더경로

> HTTP

    -   깃은 HTTP 방식의 프로토콜을 지원한다.
    -   SSH처럼 많이 사용하는 프로토콜 중 하나
    -   서버에 접속하려면 로그인을 거쳐야 한다.
    -   익명으로도 처리할 수 있다.

> SSH

    -   높은 수준의 보안 통신으로 처리하므로 안전하게 운영
    -   주소 앞에 '@ssh://계정@주소'
    -   SSH 접속을 할 때는 인증서를 만들어 사용해야 한다. 인증서를 만들면 로그인 절차를 거치지 않는다.
    -   인증서는 공개키와 개인키로 구분, 공개키는 서버에 등록하며, 개인키는 로컬에 저장
    -   익명으로 접속할 수 없다. 기업에서 운영할 때 적합한 프로토콜

> GIT

    -   깃의 데몬 서비스를 위한 전용 프로토콜 방식
    -   SSH와 유사하지만 인증 시스템이 없어 보안에 취약할 수 있다.
    -   잘 사용하지 않는 편

### 5.3.3 원격 저장소의 리모트 목록 관리

깃은 원격 자정소(서버)를 관리하는데 remote 명령어를 사용
remote 명령어를 사용하면 원격 저장소 목록을 확인할 수 있다.
동시에 등록과 취소 등 작업을 할 수 있다.

```
$ git remote -help

// 원격 저장소의 이름(별칭)을 출력
$ git remote

// -v 옵션: URL을 확인
$ git remote -v
```

### 5.3.4 주소와 별칭

로컬 저장소에 원격 저장소(서버)를 등록하려면 서버 주소가 필요하다.
깃허브 같은 저장소를 이용해보면 프로토콜 + 도메인 주소 형태로 된 것을 알 수 있다.

-   별칭 : 긴 서버 URL 문자열을 간략하게 별칭으로 만들어 사용할 수 있다.
-   origin : 대표적인 별칭, 기본적으로 원격 서버와 연결할 때 별칭으로 origin을 사용하는 것을 많이 볼 수 있다.

### 5.3.5 원격 저장소에 연결 : add 옵션

```
$ git remote add 원격저장소별칭 원격저장소URL

$ git remote add origin https://github.com/~~ 자산의 서버 주소를 입력

$ git remote -v

```

원격 저장소가 연결되면 fetch와 push 두 주소를 출력한다.

### 5.3.6 소스트리에서 원격 브랜치

원격 저장소를 등록하면 기본 master 브랜치와 달리 또 하나의 브랜치가 표시된다.

-   master는 현재 로컬 저장소를 의미, local/master 같은 별칭/브랜치는 원격 저장소의 브랜치를 의미. 즉 로컬 저장소와 서버 저장소를 구분하여 표시. 이것으로 서로 동기화한 시점을 판별할 수 있다.

### 5.3.7 별칭 이름 변경과 정보 : rename 옵션

```
$ git remote renmae 변경전 변경후

// 원격 저장소의 좀 더 상세한 정보를 확인하고 싶다면 shpw 옵션
$ git remote show 원격저장소별칭
```

### 5.3.8 원격 서버 삭제

```
$ git remote rm 원격저장소별칭

// 원격 저장소 삭제
$ git remote rm origin

// 원격 저장소 목록 확인
$ git remote -v

// 재등록
$ git reomte add origin https://github.com/~~~
```

---

## 5.4 서버 전송

### 5.4.1 push: 서버에 전송

```
$ git remote -v

// 원격 서버로 전송
$ git push 원격저장소별칭 브랜치이름
$ git push origin master

```

-   처음 푸시하면 서버에 새로운 master 브랜치를 생성한다. 그리고 로컬의 master 브랜치 안에 있는 소스 코드를 서버의 master 브랜치로 업로드한다.
-   혼자 개발할 때 백업을 위해 원격 저장소를 같이 사용하면 좋다.

---

## 5.5 자동으로 내려받기 -> 실습

### 5.5.1 clone: 복제

-   clone 명령어는 초기화 init 명령어 외에 원격 서버 접속에 필요한 추가 설정을 자동으로 수행
-   서버의 연결 설정을 마친 후 서버 안에 있는 모든 커밋된 코드 이력을들 한 번에 내려받는다.

```
$ cd 메인폴더

// 복제할 새 폴더 만들기
$ mkdir gitstudy05_clone
$ cd gitstudy05_clone

// 저장소 복제
$ git clone https://github.com/thegicode/book-git-textbook.git

// 목록 확인, .git 숨김 저장소 확인
$ ls -all

// 원격 저장소 목록 확인
$ git remote -v
```

로컬 저장소를 생성한 후, 처음으로 서버에서 코드를 내려바등ㄹ 때는 clone 명령어를 사용하면 편리하다.

### 5.5.2 pull: 서버에서 내려받기

복제 후 원격 저장소의 갱신된 내용을 추가로 내려받으려면 pull 명령어를 사용

```
$ git pull

$ git log
```

---

## 5.6 수동으로 내려받기

-   원격 저장소 내용을 내려받는 방법은 크게 두가지, pull과 fetch
-   이 두 방법의 차이는 병합을 자동으로 처라히는지 여부
-   여기서는 fetch만

### 5.6.1 자동 병합

-   pull은 원격 서버에서 현재 커밋보다 더 최신 커밋 정보가 있을 때 내려받는다.
-   내려받은 커밋 정보는 임시 영역에 저장, 스테이지 영역이 아닌 원격 저장소를 위한 전용 임시 브랜치가 따로 있다.
-   내려받은 최신 커밋들을 현재 브랜치로 자동으로 병합 처리. 여기서 병합은 원격 서버 파일과 로컬 파일을 하나로 합치는 과정.

### 5.6.2 fetch: 가져오기

-   원격 저장소에서 코드를 수동으로 내려받는 작업
-   원격 저장소에서 커밋된 코드를 임시 브랜치로 내려받는다. 내려받은 후 현재 브랜치와 자동으로 병합하지 않는다.

```
$ git fetch 원격저장소URL

$ git log
```

-   pull 명령어와 달리 fetch 명령어를 실행한 후에는 커밋이 추가된 것을 확인할 수 없다.
    원격 저장소의 커밋들만 가지고 왔을 뿐 로컬 저장소에서 어떤 작업도 하지 않는다.
-   수동 병합인 패치 동작을 하면 새로운 master 브랜치를 하나 더 생성한다. 서버/mater 형태의 임시 브랜치다. 임시 브랜치에는 커밋을 할 수 없다.

### 5.6.3 merge 명령어로 수동 병합

```
$ git merge 원격저장소별칭/브랜치이름
$ git merge origin/master

$ git log
```

---

## 5.7 순서

### 5.7.1 최신 상태

-   로컬 저장소를 최신 상태로 유지

### 5.7.2 충돌 방지

-   깃에 최신 상태에서 푸시를 허용하는 것은 충돌을 방지하기 위해서.

-   권장 순서 : pull -> coding -> commit -> pull -> push

-   인증 정보 캐시 : 인증 정보 캐시(credential cache) 기능을 이용하여 아이디와 비밀번호를 임시적으로 보관할 수 있다. 이 기능을 활성화하려면 다음과 같이 환경 설정 필요

    ```
    $ git config --global credential.helper. cache
    ```

-   원격 저장소 원리 : 깃을 원격 저장소에 연결하면 ./git/config 파일 안에 리모트 연결에 대한 설정 정보가 자동으로 추가된다.

    ```
    [remote "origin"]
        url = git@github.com:thegicode/book-git-textbook.git
        fetch = +refs/heads/*:refs/remotes/origin/*

    ```
