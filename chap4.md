# 4장 커밋

<br>

## 4.1 코드의 변화

<br>

---

<br>

## 4.2 새 파일 생성 및 감지

<br>

---

<br>

## 4.3 깃에 새 파일 등록

<br>

```
$ git add 파일이름
```

### 4.3.3 파일 등록 취소

파일을 등록한 후 커밋하지 않고 바로 삭제하려면 rm --cached 명령어 사용

```
$ git rm --cached index.html : 스테이지 삭제
```

하지만 한번이라도 커밋을 했다면 reset 명령어를 사용해야 한다. 9장으로.

> 커밋 후 삭제는 삭제 또는 변화된 것을 간주한다. 따라서 커밋된 파일은 리셋으로 삭제한 후 정리해 주어야 한다.

```
$ git reset HEAD index.htm
```

### 4.3.4 등록된 파일 이름이 변경되었을 때

```
$ git mv 파일이름 새파일이름
```

<br>

---

<br>

## 4.4 첫 번째 커밋

<br>

### 4.4.1 HEAD

-   포인터 개념, 커밋을 가리키는 묵시적 참조 포인터
-   최종적인 커밋 작업의 위치를 가리킨다.
-   처음 커밋할 때는 HEAD의 포인터가 없다. 최소 한 번 이상 커밋해야 HEAD가 존재
-   HEAD는 커밋될 때마다 한 단계씩 이동하고 마지막 커밋 위치를 가리킨다. 커밋이 변화한 최정 시점

### 4.4.2 스냅샷

-   스냅샷은 HEAD가 가리키는 커밋을 기반으로 사진을 찍는다. 이를 스테이지 영역과 비료하여 새로운 커밋으로 기록한다.
-   스냅샷 방식을 이용하여 빠르게 버전의 차이점을 처리하고, 용량을 적게 사용

### 4.4.3 파일 상태와 커밋

-   반드시 tracked 상태로 변경
-   워킹 디렉토리가 깨끗하게 정리되어 있지 않으면 커밋 명령어를 수행할 수 없다.

-   명령어롤 커밋 : commit 명령어

    ```
    $ git commit
    $ git commit -help
    ```

    -   객체로 변화하는 것과 유사하다.

-   커밋 메시지

    -   vi 에디터 이외의 에디터를 사용하고 싶다면 깃의 환경 설정을 변경한다.

    ```
    $ git config --global core.deitor "에디터경로"
    ```

    -   종료 : esc를 누른 후 <kbd>:</kbd> + <kbd>q</kbd>
    -   입력 : esc를 누른 후 <kbd>i</kbd>를 누른다
    -   작성한 후 저장과 종료는 esc를 누른 후 : <kbd>:</kbd> + <kbd>w</kbd>, <kbd>q</kbd>

-   파일 등록과 커밋을 동시에 하는 방법
    - -a 옵션은 커밋을 하기 전에 자동으로 모든 파일을 등록하는 과정을 미리 수행. 따라서 파일 등록과 커밋을 동시에 실행하는 것.

        ```
        $ git commit -a
        ```

    <br>

---

<br>

## 4.5 커밋 확인

<br>

### 스테이지 초기화

```
$ git status

```

-   working treee clean 메시지를 볼 수 있다.
-   커밋을 하면 스테이지 영역은 초기화 된다.

### 로그 기록 확인

```
$ git log
```

<br>

---

<br>

## 4.6 두 번째 커밋

<br>

### 파일 변경 사항 확인

```
$ git status
modified: index.htm 메시지가 출력된다.
```

### 수정된 파일 되돌리기

```
$ git checkout -- 수정파일이름

```

### -m 옵션, -a 옵션

```
$ git commit -am "커밋메시지"
```

-   -a 옵션은 이미 추적된 파일 상태가 변경되었을 때만 함께 사용 가능하다. 저장소를 새롭게 생성하고, 새 파일을 작성한 후라면 -am 옵션을 사용하여 커밋할 수 없다.

<br>

---

<br>

## 4.7 메시지가 없는 빈 커밋

<br>

#### --allow-empty-message 옵션

```
$ git commit --allow-empty-message -m ""
```

-   방금 전에 작성한 메시지를 수정

```
$ git commit --amend
```

<br>

---

<br>

## 4.8 커밋 아이디

<br>

### SHA1

-   해시 알고리즘 사용, 40자리의 복잡한 hexa값
-   중복되지 않은 고유의 키를 생성

### 단축키

-   7자만으로도 중복을 방지

<br>

---

<br>

## 4.9 커밋 로그

<br>

### 간략 로그

```
$ git log --pretty=short : 첫 번째 줄의 커밋 메시지만 출력
$ git show 커밋ID : 특정 커밋의 상세 정보 확인

```

### 특정 파일의 로그

```
$ git log index.html

```

### log 명령어의 여러 옵션

-   -p : diff 기능(수정한 라인 비교)을 같이 포함하여 출력
-   --stat : 히스토리를 출력
-   --pretty=oneline : 갓 커밋을 한 줄로 표시

<br>

---

<br>

## 4.10 diff 명령어

<br>

### 워킹 디렉토리 vs 스테이지 영역

```
$ git diff : 스테이지 vs 워킹 디렉토리 비교
```

### 커밋 간 차이

최신 커밋과 변경 내용을 비교

```
$ git diff head
```

### diff 내용을 추가하여 커밋

```
$ git commit -v
```
